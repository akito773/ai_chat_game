<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒãƒ£ãƒƒãƒˆRPG - ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Sans', 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .test-header {
            background: linear-gradient(135deg, #ff6b9d 0%, #ff8fb3 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .test-section {
            padding: 20px;
            border-bottom: 1px solid #eee;
        }

        .test-section h3 {
            color: #333;
            margin-bottom: 15px;
            border-left: 4px solid #ff6b9d;
            padding-left: 10px;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .status-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
        }

        .status-label {
            font-weight: bold;
            color: #666;
            font-size: 0.9em;
        }

        .status-value {
            font-size: 1.2em;
            color: #333;
            margin-top: 5px;
        }

        .btn {
            background: linear-gradient(135deg, #ff6b9d 0%, #ff8fb3 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 157, 0.3);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
        }

        .log-area {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            height: 200px;
            overflow-y: auto;
            padding: 10px;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
        }

        .character-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 15px 0;
        }

        .character-btn {
            padding: 8px 15px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .character-btn.active {
            border-color: #ff6b9d;
            background: #ff6b9d;
            color: white;
        }

        .test-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 15px 0;
        }

        .location-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }

        .location-item {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s;
        }

        .location-item:hover {
            border-color: #ff6b9d;
        }

        .location-item.current {
            border-color: #ff6b9d;
            background: rgba(255, 107, 157, 0.1);
        }

        .chat-test {
            margin: 15px 0;
        }

        .chat-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .error {
            color: #dc3545;
            background: #f8d7da;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
        }

        .success {
            color: #155724;
            background: #d4edda;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>ğŸ® ãƒãƒ£ãƒƒãƒˆRPG ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ</h1>
            <p>åŸºç›¤ã‚·ã‚¹ãƒ†ãƒ ã®å‹•ä½œç¢ºèª</p>
        </div>

        <!-- ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ -->
        <div class="test-section">
            <h3>ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–çŠ¶æ…‹</h3>
            <div class="status-grid">
                <div class="status-item">
                    <div class="status-label">GameEngine</div>
                    <div class="status-value" id="gameEngineStatus">æœªåˆæœŸåŒ–</div>
                </div>
                <div class="status-item">
                    <div class="status-label">SaveManager</div>
                    <div class="status-value" id="saveManagerStatus">æœªåˆæœŸåŒ–</div>
                </div>
                <div class="status-item">
                    <div class="status-label">MemoryManager</div>
                    <div class="status-value" id="memoryManagerStatus">æœªåˆæœŸåŒ–</div>
                </div>
                <div class="status-item">
                    <div class="status-label">LocationManager</div>
                    <div class="status-value" id="locationManagerStatus">æœªåˆæœŸåŒ–</div>
                </div>
                <div class="status-item">
                    <div class="status-label">RelationshipManager</div>
                    <div class="status-value" id="relationshipManagerStatus">æœªåˆæœŸåŒ–</div>
                </div>
            </div>
            <div class="test-controls">
                <button class="btn" onclick="initializeSystem()">ğŸš€ ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–</button>
                <button class="btn btn-secondary" onclick="resetSystem()">ğŸ”„ ãƒªã‚»ãƒƒãƒˆ</button>
                <button class="btn btn-secondary" onclick="debugSystem()">ğŸ› ãƒ‡ãƒãƒƒã‚°æƒ…å ±</button>
            </div>
        </div>

        <!-- ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç®¡ç†ãƒ†ã‚¹ãƒˆ -->
        <div class="test-section">
            <h3>ğŸ‘¥ ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç®¡ç†ãƒ†ã‚¹ãƒˆ</h3>
            <div class="character-selector" id="characterSelector">
                <!-- JavaScriptã§å‹•çš„ç”Ÿæˆ -->
            </div>
            <div class="status-grid">
                <div class="status-item">
                    <div class="status-label">é¸æŠä¸­ã‚­ãƒ£ãƒ©</div>
                    <div class="status-value" id="currentCharacter">æœªé¸æŠ</div>
                </div>
                <div class="status-item">
                    <div class="status-label">è¦ªå¯†åº¦</div>
                    <div class="status-value" id="intimacyLevel">0</div>
                </div>
                <div class="status-item">
                    <div class="status-label">é–¢ä¿‚æ€§</div>
                    <div class="status-value" id="relationshipLevel">åˆå¯¾é¢</div>
                </div>
            </div>
        </div>

        <!-- å ´æ‰€ç®¡ç†ãƒ†ã‚¹ãƒˆ -->
        <div class="test-section">
            <h3>ğŸ“ å ´æ‰€ç®¡ç†ãƒ†ã‚¹ãƒˆ</h3>
            <div class="status-item">
                <div class="status-label">ç¾åœ¨åœ°</div>
                <div class="status-value" id="currentLocation">è‡ªåˆ†ã®éƒ¨å±‹</div>
            </div>
            <div class="location-grid" id="locationGrid">
                <!-- JavaScriptã§å‹•çš„ç”Ÿæˆ -->
            </div>
        </div>

        <!-- ä¼šè©±ãƒ†ã‚¹ãƒˆ -->
        <div class="test-section">
            <h3>ğŸ’¬ ä¼šè©±ãƒ»è¨˜æ†¶ãƒ†ã‚¹ãƒˆ</h3>
            <div class="chat-test">
                <input type="text" class="chat-input" id="testMessage" placeholder="ãƒ†ã‚¹ãƒˆç”¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›...">
                <button class="btn" onclick="sendTestMessage()">ğŸ’¬ é€ä¿¡</button>
                <button class="btn btn-secondary" onclick="checkMemory()">ğŸ§  è¨˜æ†¶ç¢ºèª</button>
            </div>
            <div class="status-grid">
                <div class="status-item">
                    <div class="status-label">ä¼šè©±å›æ•°</div>
                    <div class="status-value" id="conversationCount">0</div>
                </div>
                <div class="status-item">
                    <div class="status-label">è¨˜æ†¶ãƒ‡ãƒ¼ã‚¿</div>
                    <div class="status-value" id="memoryData">ãªã—</div>
                </div>
            </div>
        </div>

        <!-- ã‚»ãƒ¼ãƒ–/ãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆ -->
        <div class="test-section">
            <h3>ğŸ’¾ ã‚»ãƒ¼ãƒ–/ãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆ</h3>
            <div class="test-controls">
                <button class="btn" onclick="saveTest()">ğŸ’¾ ãƒ†ã‚¹ãƒˆã‚»ãƒ¼ãƒ–</button>
                <button class="btn" onclick="loadTest()">ğŸ“ ãƒ†ã‚¹ãƒˆãƒ­ãƒ¼ãƒ‰</button>
                <button class="btn btn-secondary" onclick="clearSave()">ğŸ—‘ï¸ ã‚»ãƒ¼ãƒ–ã‚¯ãƒªã‚¢</button>
            </div>
            <div class="status-item">
                <div class="status-label">ã‚»ãƒ¼ãƒ–çŠ¶æ…‹</div>
                <div class="status-value" id="saveStatus">æœªä¿å­˜</div>
            </div>
        </div>

        <!-- ãƒ­ã‚°è¡¨ç¤º -->
        <div class="test-section">
            <h3>ğŸ“œ ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°</h3>
            <div class="log-area" id="systemLog"></div>
            <button class="btn btn-secondary" onclick="clearLog()">ğŸ—‘ï¸ ãƒ­ã‚°ã‚¯ãƒªã‚¢</button>
        </div>

        <!-- ã‚¨ãƒ©ãƒ¼/æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
        <div id="messageArea"></div>
    </div>

    <!-- JavaScriptèª­ã¿è¾¼ã¿ -->
    <script src="js/data/characters.js"></script>
    <script src="js/data/stories.js"></script>
    <script src="js/core/game-engine.js"></script>
    <script src="js/modules/save-manager.js"></script>
    <script src="js/modules/memory-manager.js"></script>
    <script src="js/modules/location-manager.js"></script>
    <script src="js/modules/relationship-manager.js"></script>

    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let gameEngine = null;
        let currentCharacterId = 'sakura';
        let testLog = [];

        // ãƒ­ã‚°å‡ºåŠ›é–¢æ•°
        function addLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}`;
            testLog.push(logEntry);
            
            const logArea = document.getElementById('systemLog');
            logArea.textContent = testLog.slice(-50).join('\n'); // æœ€æ–°50ä»¶
            logArea.scrollTop = logArea.scrollHeight;
            
            console.log(logEntry);
        }

        // ã‚¨ãƒ©ãƒ¼/æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
        function showMessage(message, type = 'info') {
            const messageArea = document.getElementById('messageArea');
            const div = document.createElement('div');
            div.className = type === 'error' ? 'error' : 'success';
            div.textContent = message;
            messageArea.appendChild(div);
            
            setTimeout(() => {
                div.remove();
            }, 5000);
        }

        // ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
        async function initializeSystem() {
            try {
                addLog('ğŸš€ ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–é–‹å§‹');
                
                // GameEngineåˆæœŸåŒ–
                gameEngine = new GameEngine();
                await gameEngine.initialize();
                
                updateSystemStatus();
                initializeCharacterSelector();
                initializeLocationGrid();
                
                addLog('âœ… ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å®Œäº†');
                showMessage('ã‚·ã‚¹ãƒ†ãƒ ãŒæ­£å¸¸ã«åˆæœŸåŒ–ã•ã‚Œã¾ã—ãŸï¼', 'success');
                
            } catch (error) {
                addLog(`âŒ åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                showMessage(`åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }

        // ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹æ›´æ–°
        function updateSystemStatus() {
            const statuses = {
                gameEngineStatus: gameEngine ? 'âœ… æ­£å¸¸' : 'âŒ ã‚¨ãƒ©ãƒ¼',
                saveManagerStatus: gameEngine?.modules.savemanager ? 'âœ… æ­£å¸¸' : 'âŒ ã‚¨ãƒ©ãƒ¼',
                memoryManagerStatus: gameEngine?.modules.memorymanager ? 'âœ… æ­£å¸¸' : 'âŒ ã‚¨ãƒ©ãƒ¼',
                locationManagerStatus: gameEngine?.modules.locationmanager ? 'âœ… æ­£å¸¸' : 'âŒ ã‚¨ãƒ©ãƒ¼',
                relationshipManagerStatus: gameEngine?.modules.relationshipmanager ? 'âœ… æ­£å¸¸' : 'âŒ ã‚¨ãƒ©ãƒ¼'
            };
            
            for (const [id, status] of Object.entries(statuses)) {
                document.getElementById(id).textContent = status;
            }
        }

        // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠå™¨åˆæœŸåŒ–
        function initializeCharacterSelector() {
            const selector = document.getElementById('characterSelector');
            selector.innerHTML = '';
            
            for (const [characterId, character] of Object.entries(window.CharacterData)) {
                const btn = document.createElement('div');
                btn.className = `character-btn ${characterId === currentCharacterId ? 'active' : ''}`;
                btn.textContent = `${character.emoji} ${character.name}`;
                btn.onclick = () => selectCharacter(characterId);
                selector.appendChild(btn);
            }
        }

        // å ´æ‰€ã‚°ãƒªãƒƒãƒ‰åˆæœŸåŒ–
        function initializeLocationGrid() {
            const grid = document.getElementById('locationGrid');
            const locations = gameEngine?.modules.locationmanager?.locations || {};
            
            grid.innerHTML = '';
            
            for (const [locationId, location] of Object.entries(locations)) {
                const item = document.createElement('div');
                item.className = `location-item ${locationId === 'home' ? 'current' : ''}`;
                item.textContent = location.name;
                item.onclick = () => moveToLocation(locationId);
                grid.appendChild(item);
            }
        }

        // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠ
        function selectCharacter(characterId) {
            currentCharacterId = characterId;
            addLog(`ğŸ‘¤ ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠ: ${window.CharacterData[characterId].name}`);
            
            // UIæ›´æ–°
            initializeCharacterSelector();
            updateCharacterStatus();
        }

        // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼çŠ¶æ…‹æ›´æ–°
        function updateCharacterStatus() {
            const character = window.CharacterData[currentCharacterId];
            const relationship = gameEngine?.modules.relationshipmanager?.getRelationship(currentCharacterId);
            
            document.getElementById('currentCharacter').textContent = character.name;
            document.getElementById('intimacyLevel').textContent = relationship?.intimacy || 0;
            document.getElementById('relationshipLevel').textContent = relationship?.intimacyName || 'åˆå¯¾é¢';
        }

        // å ´æ‰€ç§»å‹•
        async function moveToLocation(locationId) {
            try {
                const result = await gameEngine.moveToLocation(locationId);
                if (result.success) {
                    addLog(`ğŸ“ å ´æ‰€ç§»å‹•: ${result.location.name}`);
                    document.getElementById('currentLocation').textContent = result.location.name;
                    
                    // UIæ›´æ–°
                    document.querySelectorAll('.location-item').forEach(item => {
                        item.classList.remove('current');
                    });
                    event.target.classList.add('current');
                } else {
                    addLog(`âŒ ç§»å‹•å¤±æ•—: ${result.error}`, 'error');
                }
            } catch (error) {
                addLog(`âŒ ç§»å‹•ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }

        // ãƒ†ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
        async function sendTestMessage() {
            const input = document.getElementById('testMessage');
            const message = input.value.trim();
            
            if (!message || !gameEngine) {
                addLog('âŒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¾ãŸã¯ã‚²ãƒ¼ãƒ ã‚¨ãƒ³ã‚¸ãƒ³ãŒç„¡åŠ¹ã§ã™');
                return;
            }
            
            try {
                addLog(`ğŸ’¬ é€ä¿¡: ${message}`);
                
                // ãƒ¡ãƒ¢ãƒªãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã«è¨˜éŒ²
                gameEngine.modules.memorymanager.addConversation(message, true, currentCharacterId);
                
                // RelationshipManagerã®å­˜åœ¨ç¢ºèª
                if (!gameEngine.modules.relationshipmanager) {
                    addLog('âŒ RelationshipManagerãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“', 'error');
                    return;
                }
                
                // é–¢ä¿‚æ€§æ›´æ–°
                const result = gameEngine.modules.relationshipmanager.updateIntimacyFromConversation(currentCharacterId, message);
                
                addLog(`ğŸ’• è¦ªå¯†åº¦å¤‰åŒ–: ${result.oldIntimacy} â†’ ${result.newIntimacy}`);
                
                if (result.levelUp) {
                    addLog(`ğŸ‰ é–¢ä¿‚æ€§ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—: ${result.newLevel.name}`);
                }
                
                updateCharacterStatus();
                updateConversationCount();
                
                input.value = '';
                
            } catch (error) {
                addLog(`âŒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                console.error('è©³ç´°ã‚¨ãƒ©ãƒ¼:', error);
            }
        }

        // è¨˜æ†¶ç¢ºèª
        function checkMemory() {
            try {
                const memoryInfo = gameEngine.modules.memorymanager.getMemoryDebugInfo();
                addLog(`ğŸ§  è¨˜æ†¶æƒ…å ±: ${JSON.stringify(memoryInfo)}`);
                
                document.getElementById('memoryData').textContent = 
                    `çŸ­æœŸ:${memoryInfo.shortTermCount} é•·æœŸ:${memoryInfo.longTermCount}`;
                    
            } catch (error) {
                addLog(`âŒ è¨˜æ†¶ç¢ºèªã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }

        // ä¼šè©±å›æ•°æ›´æ–°
        function updateConversationCount() {
            const relationship = gameEngine?.modules.relationshipmanager?.getRelationship(currentCharacterId);
            document.getElementById('conversationCount').textContent = relationship?.totalInteractions || 0;
        }

        // ã‚»ãƒ¼ãƒ–ãƒ†ã‚¹ãƒˆ
        async function saveTest() {
            try {
                const result = await gameEngine.modules.savemanager.saveGame('test');
                if (result.success) {
                    addLog('ğŸ’¾ ãƒ†ã‚¹ãƒˆã‚»ãƒ¼ãƒ–å®Œäº†');
                    document.getElementById('saveStatus').textContent = 'ä¿å­˜æ¸ˆã¿';
                    showMessage('ã‚»ãƒ¼ãƒ–ãŒå®Œäº†ã—ã¾ã—ãŸï¼', 'success');
                } else {
                    addLog(`âŒ ã‚»ãƒ¼ãƒ–ã‚¨ãƒ©ãƒ¼: ${result.error}`, 'error');
                }
            } catch (error) {
                addLog(`âŒ ã‚»ãƒ¼ãƒ–ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }

        // ãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆ
        async function loadTest() {
            try {
                const data = await gameEngine.modules.savemanager.loadGame('test');
                if (data) {
                    addLog('ğŸ“ ãƒ†ã‚¹ãƒˆãƒ­ãƒ¼ãƒ‰å®Œäº†');
                    showMessage('ãƒ­ãƒ¼ãƒ‰ãŒå®Œäº†ã—ã¾ã—ãŸï¼', 'success');
                } else {
                    addLog('âŒ ãƒ­ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ãªã—', 'error');
                }
            } catch (error) {
                addLog(`âŒ ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }

        // ã‚»ãƒ¼ãƒ–ã‚¯ãƒªã‚¢
        async function clearSave() {
            try {
                await gameEngine.modules.savemanager.clearSave();
                addLog('ğŸ—‘ï¸ ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢å®Œäº†');
                document.getElementById('saveStatus').textContent = 'æœªä¿å­˜';
                showMessage('ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ', 'success');
            } catch (error) {
                addLog(`âŒ ã‚¯ãƒªã‚¢ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }

        // ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚»ãƒƒãƒˆ
        function resetSystem() {
            gameEngine = null;
            currentCharacterId = 'sakura';
            
            updateSystemStatus();
            document.getElementById('currentCharacter').textContent = 'æœªé¸æŠ';
            document.getElementById('intimacyLevel').textContent = '0';
            document.getElementById('relationshipLevel').textContent = 'åˆå¯¾é¢';
            
            addLog('ğŸ”„ ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚»ãƒƒãƒˆå®Œäº†');
            showMessage('ã‚·ã‚¹ãƒ†ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ', 'success');
        }

        // ãƒ‡ãƒãƒƒã‚°æƒ…å ±
        function debugSystem() {
            if (gameEngine) {
                console.log('ğŸ› GameEngine Debug:');
                console.log('-', gameEngine);
                console.log('- Modules:', gameEngine.modules);
                
                addLog('ğŸ› ãƒ‡ãƒãƒƒã‚°æƒ…å ±:');
                addLog(`- GameEngine: ${gameEngine ? 'âœ…' : 'âŒ'}`);
                addLog(`- SaveManager: ${gameEngine?.modules.savemanager ? 'âœ…' : 'âŒ'}`);
                addLog(`- MemoryManager: ${gameEngine?.modules.memorymanager ? 'âœ…' : 'âŒ'}`);
                addLog(`- LocationManager: ${gameEngine?.modules.locationmanager ? 'âœ…' : 'âŒ'}`);
                addLog(`- RelationshipManager: ${gameEngine?.modules.relationshipmanager ? 'âœ…' : 'âŒ'}`);
                
                if (gameEngine.modules.relationshipmanager) {
                    addLog('- RelationshipManagerãƒ¡ã‚½ãƒƒãƒ‰ç¢ºèª:');
                    addLog(`  - updateIntimacyFromConversation: ${typeof gameEngine.modules.relationshipmanager.updateIntimacyFromConversation}`);
                }
                
                gameEngine.debug();
                gameEngine.modules.relationshipmanager?.debugRelationshipInfo();
                gameEngine.modules.locationmanager?.debugLocationInfo();
            } else {
                addLog('âŒ GameEngineãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“');
            }
        }

        // ãƒ­ã‚°ã‚¯ãƒªã‚¢
        function clearLog() {
            testLog = [];
            document.getElementById('systemLog').textContent = '';
            addLog('ğŸ—‘ï¸ ãƒ­ã‚°ã‚¯ãƒªã‚¢');
        }

        // Enterã‚­ãƒ¼ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('testMessage').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendTestMessage();
                }
            });
        });
    </script>

</body>
</html>