# 🎮 チャットRPG開発進捗記録

## 📊 プロジェクト概要
- **プロジェクト名**: ai_chat_game (ライトノベル半巻レベルのチャットRPG)
- **開始日**: 2025-05-29
- **技術スタック**: HTML, CSS, JavaScript, PHP, OpenAI API
- **目標**: 4キャラクター対応、ストーリー分岐、親密度システム

## 🏗️ 実装完了状況

### ✅ Phase 1: 基盤システム構築 (完了)
**実装ファイル**:
- `js/core/game-engine.js` - メインゲームエンジン
- `js/modules/save-manager.js` - セーブ/ロード機能 (10スロット対応)
- `js/modules/memory-manager.js` - 会話記憶システム (短期/長期記憶)
- `js/modules/location-manager.js` - 場所管理システム (8箇所)
- `js/modules/relationship-manager.js` - 関係性管理 (7段階親密度)

**主要機能**:
- 会話の継続性 (名前記憶、過去会話参照)
- 場所システム (自宅、カフェ、公園、図書館など)
- キャラ別親密度管理 (初対面→運命の人)
- ストーリーチャプター管理
- 自動セーブ機能

**テスト状況**: ✅ 全機能正常動作確認済み

### ✅ Phase 2: スマホ縦専用UI実装 (完了)
**実装ファイル**:
- `chat_game_mobile.html` - メインゲームページ
- `assets/backgrounds/` - 背景画像 (SVG形式)

**UI機能**:
- ビジュアルノベル風レイアウト
- ステータスバー (キャラ名・親密度・場所表示)
- アクションバー (移動・キャラ変更・ストーリー・セーブ)
- チャットエリア (タイピングインジケーター付き)
- モーダルシステム

**テスト状況**: ✅ PC動作確認済み、⚠️ 一部スマホでチャット表示問題

### 🚧 Phase 3: ストーリーシステム統合 (次の実装予定)
**予定実装**:
- 本格的ストーリーデータ作成
- 選択肢システム実装
- ストーリー進行UI作成
- キャラクター別ストーリー分岐

## 👥 キャラクター設定

### 🌸 さくら (Sakura)
- **属性**: 学園アイドル、元気、明るい
- **テーマ**: 夢への挫折と再生
- **特別場所**: ライブハウス
- **キーワード**: 歌、アイドル、夢、音楽

### 📚 ミサキ (Misaki)
- **属性**: 文学少女、知的、内気
- **テーマ**: 心を閉ざした少女との信頼関係構築
- **特別場所**: 図書館
- **キーワード**: 本、読書、文学、静か

### ⚡ アキラ (Akira)
- **属性**: 運動部エース、クール、負けず嫌い
- **テーマ**: 競争社会での孤独と真の強さの発見
- **特別場所**: ジム
- **キーワード**: 運動、スポーツ、練習、努力

### ❄️ ユキ (Yuki)
- **属性**: お嬢様、上品、優雅
- **テーマ**: 家族の期待と自分の気持ちの葛藤
- **特別場所**: 美術館
- **キーワード**: 上品、美しい、芸術、文化

## 🏢 環境・デプロイ情報

### ローカル環境
- **パス**: `C:\xampp2\htdocs\ai_chat_game`
- **サーバー**: XAMPP
- **URL**: `http://localhost/ai_chat_game/`

### 本番環境
- **サーバー**: さくらVPS
- **パス**: `/var/www/html/ai_chat_game` 
- **URL**: `http://tk2-411-46534.vs.sakura.ne.jp/ai_chat_game/`
- **Git**: Private Repository (GitHub)

### 主要ページ
- **テストページ**: `test_system.html` (基盤システム動作確認)
- **モバイル版**: `chat_game_mobile.html` (メインゲーム)
- **従来版**: `multi_character.html` (既存安定版)

## 🔧 技術仕様

### データ構造
```javascript
// プレイヤーデータ
playerData = {
    profile: { name, level, totalExp },
    location: 'home',
    inventory: [],
    memories: {
        shortTerm: [], // 直近会話
        longTerm: {}, // 要約された重要情報
        keywords: [] // ユーザー特徴
    },
    relationships: {
        sakura: { intimacy, events, status },
        misaki: { intimacy, events, status }
    }
}
```

### 親密度システム
- **7段階**: 初対面(0) → 知り合い(20) → 友達(50) → 親友(100) → 恋人候補(150) → 恋人(200) → 運命の人(300)
- **経験値獲得**: 基本2EXP + ボーナス(長文+1、感情+2、深い会話+4、キャラ理解+6)

### 記憶システム
- **短期記憶**: 直近10回の会話を保持
- **長期記憶**: 重要度0.5以上の会話を要約して50件保持
- **キーワード抽出**: 名前、好み、感情を自動抽出

## 🐛 既知の問題

### 🔴 要修正
- 一部スマホでチャット部分が表示されない (CSS height問題の可能性)

### 🟡 改善検討
- 背景画像の実画像化 (現在SVGプレースホルダー)
- キャラクター立ち絵の実画像化
- API連携の強化

## 📋 次の作業タスク

### 優先度高
1. **ストーリーシステム統合** - 本格的な物語体験の実装
2. **選択肢システム** - プレイヤーの選択による分岐
3. **キャラクター切り替え機能** - UI統合

### 優先度中
1. **エンディングシステム** - 複数エンディング実装
2. **セーブ/ロード UI** - ユーザーフレンドリーなインターフェース
3. **場所移動システム** - 本格的な場所移動とイベント

### 優先度低
1. **スマホ表示問題修正** - CSS調整
2. **画像素材の充実** - 実際の背景・キャラ画像
3. **パフォーマンス最適化**

## 💡 開発のポイント

### 成功している部分
- **モジュール分離設計**: 拡張しやすい構造
- **イベント駆動**: 各システムが独立して動作
- **データ永続化**: セーブ/ロード機能の安定性
- **会話継続性**: AIが過去の会話を覚えている

### 学んだ教訓
- **環境差異対応**: ローカルとサーバーでの動作確認の重要性
- **段階的実装**: 基盤→UI→機能の順序が効果的
- **テスト重要性**: 早期テストで問題を発見・修正

## 🎯 最終目標

**ライトノベル半巻（3-4万文字）レベルの深いストーリー体験を持つチャットRPG**

- 各キャラクター8,000-10,000文字のストーリー
- 選択肢による分岐
- 複数エンディング
- 会話の継続性と記憶
- スマホで快適にプレイ可能

---

**最終更新**: 2025-05-29
**ステータス**: Phase 2完了、Phase 3準備中